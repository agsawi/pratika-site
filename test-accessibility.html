<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Navigation Accessibility Test</title>
    <style>
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }
        
        .focus\:not-sr-only:focus {
            position: static;
            width: auto;
            height: auto;
            padding: 0.5rem 1rem;
            margin: 0;
            overflow: visible;
            clip: auto;
            white-space: normal;
        }
        
        .hs-dropdown-menu {
            display: none;
        }
        
        .hs-dropdown-open .hs-dropdown-menu {
            display: block;
        }
        
        button:focus, a:focus {
            outline: 2px solid #1e3a8a;
            outline-offset: 2px;
        }
        
        .hs-dropdown button {
            background: #f3f4f6;
            border: 1px solid #d1d5db;
            padding: 0.5rem 1rem;
            cursor: pointer;
        }
        
        .hs-dropdown-menu {
            background: white;
            border: 1px solid #d1d5db;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            padding: 0.5rem;
            margin-top: 0.25rem;
        }
        
        .hs-dropdown-menu a {
            display: block;
            padding: 0.5rem;
            text-decoration: none;
            color: #374151;
        }
        
        .hs-dropdown-menu a:hover,
        .hs-dropdown-menu a:focus {
            background: #f3f4f6;
        }
    </style>
</head>
<body>
    <!-- Skip navigation link -->
    <a href="#main-content" class="sr-only focus:not-sr-only">Pular para o conteúdo principal</a>
    
    <!-- Navigation -->
    <nav aria-label="Global">
        <div class="hs-dropdown">
            <button 
                type="button" 
                data-hs-dropdown-toggle
                aria-expanded="false"
                aria-haspopup="menu"
                aria-label="Sobre a Pratika menu"
            >
                Sobre a Pratika
                <svg aria-hidden="true" width="16" height="16">
                    <path d="M4 6l4 4 4-4" stroke="currentColor" fill="none"/>
                </svg>
            </button>
            <div class="hs-dropdown-menu" role="menu" aria-orientation="vertical" aria-label="Sobre a Pratika submenu">
                <a href="/sobre-nos" role="menuitem" tabindex="-1" aria-label="Conheça a Prátika">Conheça a Prátika</a>
                <a href="/esg" role="menuitem" tabindex="-1" aria-label="Compromisso ESG">Compromisso ESG</a>
                <a href="/etica-e-compliance" role="menuitem" tabindex="-1" aria-label="Ética e Compliance">Ética e Compliance</a>
            </div>
        </div>
        
        <div class="hs-dropdown">
            <button 
                type="button" 
                data-hs-dropdown-toggle
                aria-expanded="false"
                aria-haspopup="menu"
                aria-label="Serviços menu"
            >
                Serviços
                <svg aria-hidden="true" width="16" height="16">
                    <path d="M4 6l4 4 4-4" stroke="currentColor" fill="none"/>
                </svg>
            </button>
            <div class="hs-dropdown-menu" role="menu" aria-orientation="vertical" aria-label="Serviços submenu">
                <a href="/servicos/limpeza-e-conservacao" role="menuitem" tabindex="-1" aria-label="Limpeza e Conservação Ambiental. Serviços completos de limpeza e manutenção ambiental">
                    Limpeza e Conservação Ambiental
                </a>
                <a href="/servicos/portaria-desarmada" role="menuitem" tabindex="-1" aria-label="Portaria Desarmada. Serviços de portaria e controle de acesso">
                    Portaria Desarmada
                </a>
            </div>
        </div>
    </nav>
    
    <!-- Live region for announcements -->
    <div id="navigation-announcements" aria-live="polite" aria-atomic="true" class="sr-only"></div>
    
    <!-- Main content -->
    <main id="main-content">
        <h1>Main Content</h1>
        <p>This is a test page for navigation accessibility.</p>
        
        <h2>Keyboard Navigation Instructions:</h2>
        <ul>
            <li><strong>Tab:</strong> Navigate between dropdown triggers</li>
            <li><strong>Enter/Space:</strong> Open dropdown menu</li>
            <li><strong>Arrow Down:</strong> Open menu and focus first item</li>
            <li><strong>Arrow Up:</strong> Open menu and focus last item</li>
            <li><strong>Arrow Down/Up:</strong> Navigate between menu items</li>
            <li><strong>Home:</strong> Focus first menu item</li>
            <li><strong>End:</strong> Focus last menu item</li>
            <li><strong>Escape:</strong> Close menu and return focus to trigger</li>
            <li><strong>Tab:</strong> Close menu and move to next element</li>
        </ul>
    </main>

    <!-- Simple dropdown simulation script -->
    <script>
        // Simple dropdown functionality for testing
        document.addEventListener('DOMContentLoaded', function() {
            const dropdowns = document.querySelectorAll('.hs-dropdown');
            
            dropdowns.forEach(dropdown => {
                const trigger = dropdown.querySelector('[data-hs-dropdown-toggle]');
                const menu = dropdown.querySelector('.hs-dropdown-menu');
                const menuItems = menu.querySelectorAll('[role="menuitem"]');
                
                let isOpen = false;
                let currentFocusIndex = -1;
                
                function openDropdown() {
                    isOpen = true;
                    dropdown.classList.add('hs-dropdown-open');
                    trigger.setAttribute('aria-expanded', 'true');
                    menu.style.display = 'block';
                }
                
                function closeDropdown() {
                    isOpen = false;
                    dropdown.classList.remove('hs-dropdown-open');
                    trigger.setAttribute('aria-expanded', 'false');
                    menu.style.display = 'none';
                    currentFocusIndex = -1;
                    updateMenuItemTabindex();
                }
                
                function updateMenuItemTabindex() {
                    menuItems.forEach((item, index) => {
                        item.setAttribute('tabindex', index === currentFocusIndex ? '0' : '-1');
                    });
                }
                
                function focusMenuItem(index) {
                    if (index >= 0 && index < menuItems.length) {
                        currentFocusIndex = index;
                        updateMenuItemTabindex();
                        menuItems[index].focus();
                    }
                }
                
                // Trigger events
                trigger.addEventListener('click', () => {
                    if (isOpen) {
                        closeDropdown();
                    } else {
                        openDropdown();
                    }
                });
                
                trigger.addEventListener('keydown', (e) => {
                    switch (e.key) {
                        case 'Enter':
                        case ' ':
                        case 'ArrowDown':
                            e.preventDefault();
                            if (!isOpen) openDropdown();
                            focusMenuItem(0);
                            break;
                        case 'ArrowUp':
                            e.preventDefault();
                            if (!isOpen) openDropdown();
                            focusMenuItem(menuItems.length - 1);
                            break;
                        case 'Escape':
                            if (isOpen) {
                                e.preventDefault();
                                closeDropdown();
                                trigger.focus();
                            }
                            break;
                    }
                });
                
                // Menu events
                menu.addEventListener('keydown', (e) => {
                    switch (e.key) {
                        case 'ArrowDown':
                            e.preventDefault();
                            const nextIndex = (currentFocusIndex + 1) % menuItems.length;
                            focusMenuItem(nextIndex);
                            break;
                        case 'ArrowUp':
                            e.preventDefault();
                            const prevIndex = currentFocusIndex === 0 ? menuItems.length - 1 : currentFocusIndex - 1;
                            focusMenuItem(prevIndex);
                            break;
                        case 'Home':
                            e.preventDefault();
                            focusMenuItem(0);
                            break;
                        case 'End':
                            e.preventDefault();
                            focusMenuItem(menuItems.length - 1);
                            break;
                        case 'Escape':
                            e.preventDefault();
                            closeDropdown();
                            trigger.focus();
                            break;
                        case 'Tab':
                            closeDropdown();
                            break;
                    }
                });
                
                // Close on outside click
                document.addEventListener('click', (e) => {
                    if (!dropdown.contains(e.target)) {
                        closeDropdown();
                    }
                });
            });
        });
    </script>
</body>
</html>